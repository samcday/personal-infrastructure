# https://github.com/prometheus-community/helm-charts/blob/main/charts/kube-prometheus-stack/values.yaml
kubeApiServer:
  enabled: false
kubeControllerManager:
  serviceMonitor:
    insecureSkipVerify: true
kubeEtcd:
  service:
    port: 2381
    targetPort: 2381
kubeProxy:
  enabled: false
kubeScheduler:
  serviceMonitor:
    insecureSkipVerify: true
prometheus:
  prometheusSpec:
    enableAdminAPI: true
    podMonitorSelectorNilUsesHelmValues: false
    resources:
      limits:
        memory: 2048Mi
    retention: 30d
    retentionSize: 30GB
    serviceMonitorSelectorNilUsesHelmValues: false
    storageSpec:
      volumeClaimTemplate:
        spec:
          storageClassName: hcloud-volumes
          accessModes: [ReadWriteOnce]
          resources:
            requests:
              storage: 50Gi
    walCompression: true
  service:
    annotations:
      external-dns.alpha.kubernetes.io/internal-hostname: prometheus.samcday.com
alertmanager:
  config:
    route:
      routes:
      - matchers:
        - alertname = Watchdog
        receiver: deadmanssnitch
        group_wait: 0s
        repeat_interval: 30m
      - matchers:
        - alertname != Watchdog
        receiver: pagerduty
    receivers:
    - name: deadmanssnitch
      webhook_configs:
      - url: "" # Set in secrets
    - name: pagerduty
      pagerduty_configs:
      - service_key: "" # Set in secrets
    - name: "null"
  service:
    annotations:
      external-dns.alpha.kubernetes.io/internal-hostname: alertmanager.samcday.com
grafana:
  dashboards:
    default:
      # rook-ceph-cluster:
      #   gnetId: 2842
      #   revision: 14
      #   datasource: Prometheus
  dashboardProviders:
    dashboardproviders.yaml:
      apiVersion: 1
      providers:
      - name: 'default'
        orgId: 1
        folder: ''
        type: file
        disableDeletion: false
        editable: true
        options:
          path: /var/lib/grafana/dashboards/default
  service:
    annotations:
      external-dns.alpha.kubernetes.io/internal-hostname: grafana.samcday.com
